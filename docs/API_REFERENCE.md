# üìö API Reference - WoodenBoardsShop

–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è REST API —Å–∏—Å—Ç–µ–º—ã WoodenBoardsShop.

## üåê –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- **Base URL**: `http://localhost:8000/api/v1`
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: `http://localhost:8000/docs` (Swagger UI)
- **–§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö**: JSON
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: JWT —Ç–æ–∫–µ–Ω—ã —á–µ—Ä–µ–∑ Keycloak

## üìä –û—Å–Ω–æ–≤–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏

–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª—è–µ—Ç 9 –æ—Å–Ω–æ–≤–Ω—ã–º–∏ —Å—É—â–Ω–æ—Å—Ç—è–º–∏:

1. **Buyer** - –ø–æ–∫—É–ø–∞—Ç–µ–ª–∏ —Ç–æ–≤–∞—Ä–æ–≤
2. **Seller** - –ø—Ä–æ–¥–∞–≤—Ü—ã —Ç–æ–≤–∞—Ä–æ–≤
3. **Product** - —Ç–æ–≤–∞—Ä—ã –≤ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–µ
4. **WoodType** - —Ç–∏–ø—ã –¥—Ä–µ–≤–µ—Å–∏–Ω—ã
5. **WoodTypePrice** - –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ —Ü–µ–Ω—ã –Ω–∞ –¥—Ä–µ–≤–µ—Å–∏–Ω—É
6. **Image** - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤
7. **WoodenBoard** - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã AI –∞–Ω–∞–ª–∏–∑–∞ –¥–æ—Å–æ–∫
8. **ChatThread** - –ø–æ—Ç–æ–∫–∏ –æ–±—â–µ–Ω–∏—è
9. **ChatMessage** - —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç–∞—Ö

## üîß –°–∏—Å—Ç–µ–º–Ω—ã–µ endpoints

### Health Check
```http
GET /api/v1/health
```
–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã.

### Demo endpoints
```http
POST /api/v1/demo/set-redis
GET /api/v1/demo/get-redis
```
–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ endpoints –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Redis.

## üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

### –ü–æ–∫—É–ø–∞—Ç–µ–ª–∏ (Buyers)
```http
GET    /api/v1/buyers           # –°–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π (–ø–∞–≥–∏–Ω–∞—Ü–∏—è)
POST   /api/v1/buyers           # –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è
GET    /api/v1/buyers/{id}      # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –ø–æ ID
PUT    /api/v1/buyers/{id}      # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è
DELETE /api/v1/buyers/{id}      # –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è
```

### –ü—Ä–æ–¥–∞–≤—Ü—ã (Sellers)
```http
GET    /api/v1/sellers          # –°–ø–∏—Å–æ–∫ –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ (–ø–∞–≥–∏–Ω–∞—Ü–∏—è)
POST   /api/v1/sellers          # –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–¥–∞–≤—Ü–∞
GET    /api/v1/sellers/{id}     # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ–¥–∞–≤—Ü–∞ –ø–æ ID
PUT    /api/v1/sellers/{id}     # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–¥–∞–≤—Ü–∞
DELETE /api/v1/sellers/{id}     # –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–¥–∞–≤—Ü–∞
```

## üõí –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏

### –¢–æ–≤–∞—Ä—ã (Products)
```http
GET    /api/v1/products                # –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ (–ø–∞–≥–∏–Ω–∞—Ü–∏—è)
POST   /api/v1/products                # –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
POST   /api/v1/products/with-image     # –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ —Å AI –∞–Ω–∞–ª–∏–∑–æ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
GET    /api/v1/products/{id}           # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –ø–æ ID
PUT    /api/v1/products/{id}           # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
DELETE /api/v1/products/{id}           # –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å**: endpoint `/products/with-image` –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å AI –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–º –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–æ—Å–æ–∫.

### –¢–∏–ø—ã –¥—Ä–µ–≤–µ—Å–∏–Ω—ã (Wood Types)
```http
GET    /api/v1/wood_types       # –°–ø–∏—Å–æ–∫ —Ç–∏–ø–æ–≤ –¥—Ä–µ–≤–µ—Å–∏–Ω—ã
POST   /api/v1/wood_types       # –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∏–ø–∞ –¥—Ä–µ–≤–µ—Å–∏–Ω—ã
GET    /api/v1/wood_types/{id}  # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–∏–ø–∞ –ø–æ ID
PUT    /api/v1/wood_types/{id}  # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∏–ø–∞
DELETE /api/v1/wood_types/{id}  # –£–¥–∞–ª–µ–Ω–∏–µ —Ç–∏–ø–∞
```

### –¶–µ–Ω—ã –Ω–∞ –¥—Ä–µ–≤–µ—Å–∏–Ω—É (Wood Type Prices)
```http
GET    /api/v1/wood_type_prices       # –ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω (–ø–∞–≥–∏–Ω–∞—Ü–∏—è)
POST   /api/v1/wood_type_prices       # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω—ã
GET    /api/v1/wood_type_prices/{id}  # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ü–µ–Ω—ã –ø–æ ID
PUT    /api/v1/wood_type_prices/{id}  # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω—ã
DELETE /api/v1/wood_type_prices/{id}  # –£–¥–∞–ª–µ–Ω–∏–µ —Ü–µ–Ω—ã
```

## üñºÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏

### –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (Images)
```http
GET    /api/v1/images       # –°–ø–∏—Å–æ–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–ø–∞–≥–∏–Ω–∞—Ü–∏—è)
POST   /api/v1/images       # –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
GET    /api/v1/images/{id}  # –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ ID
DELETE /api/v1/images/{id}  # –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
```

## ü§ñ AI –∞–Ω–∞–ª–∏–∑ –¥–æ—Å–æ–∫

### –î–µ—Ä–µ–≤—è–Ω–Ω—ã–µ –¥–æ—Å–∫–∏ (Wooden Boards)
```http
GET    /api/v1/wooden-boards       # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ (–ø–∞–≥–∏–Ω–∞—Ü–∏—è)
POST   /api/v1/wooden-boards       # –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –∞–Ω–∞–ª–∏–∑–∞
GET    /api/v1/wooden-boards/{id}  # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø–æ ID
PUT    /api/v1/wooden-boards/{id}  # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
DELETE /api/v1/wooden-boards/{id}  # –£–¥–∞–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
```

## üí¨ –°–∏—Å—Ç–µ–º–∞ —á–∞—Ç–æ–≤

### –ü–æ—Ç–æ–∫–∏ —á–∞—Ç–æ–≤ (Chat Threads)
```http
GET    /api/v1/chat_threads       # –°–ø–∏—Å–æ–∫ –ø–æ—Ç–æ–∫–æ–≤ (–ø–∞–≥–∏–Ω–∞—Ü–∏—è)
POST   /api/v1/chat_threads       # –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–∞
GET    /api/v1/chat_threads/{id}  # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞ –ø–æ ID
PUT    /api/v1/chat_threads/{id}  # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞
DELETE /api/v1/chat_threads/{id}  # –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞
```

### –°–æ–æ–±—â–µ–Ω–∏—è —á–∞—Ç–æ–≤ (Chat Messages)
```http
GET    /api/v1/chat_messages       # –°–ø–∏—Å–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π (–ø–∞–≥–∏–Ω–∞—Ü–∏—è)
POST   /api/v1/chat_messages       # –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
GET    /api/v1/chat_messages/{id}  # –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ ID
PUT    /api/v1/chat_messages/{id}  # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
DELETE /api/v1/chat_messages/{id}  # –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
```

## üìù –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö

### –ü–∞–≥–∏–Ω–∞—Ü–∏—è
–í—Å–µ GET endpoints —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –ø–∞–≥–∏–Ω–∞—Ü–∏—é:

```json
{
  "data": [...],
  "pagination": {
    "total": 150,
    "limit": 20,
    "offset": 0
  }
}
```

### UUID –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
–í—Å–µ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã–µ –æ–±—ä–µ–∫—Ç—ã —Ç—Ä–µ–±—É—é—Ç UUID, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–π –Ω–∞ frontend:

```json
{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "...": "other fields"
}
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ HTTP –∫–æ–¥—ã –æ—à–∏–±–æ–∫ —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏:

```json
{
  "detail": "–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏",
  "error_code": "VALIDATION_ERROR"
}
```

## üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å AI –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–º

### –ê–Ω–∞–ª–∏–∑ –æ–±—ä–µ–º–∞ –¥–æ—Å–æ–∫
Endpoint `/products/with-image` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ—Å–æ–∫
2. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ AI –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å (–ø–æ—Ä—Ç 8001)
3. –ü–æ–ª—É—á–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ (—Ä–∞–∑–º–µ—Ä—ã, –æ–±—ä–µ–º)
4. –°–æ–∑–¥–∞–µ—Ç —Ç–æ–≤–∞—Ä —Å —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

### AI –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å endpoints
- **Base URL**: `http://localhost:8001`
- **–ê–Ω–∞–ª–∏–∑ –¥–æ—Å–æ–∫**: `POST /wooden_boards_volume_seg/`
- **Health check**: `GET /healthcheck`

## üìã –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ —Å AI –∞–Ω–∞–ª–∏–∑–æ–º
```http
POST /api/v1/products/with-image
Content-Type: multipart/form-data

{
  "product_data": {
    "id": "uuid",
    "title": "–î–æ—Å–∫–∏ —Å–æ—Å–Ω–æ–≤—ã–µ",
    "seller_id": "seller_uuid",
    "wood_type_id": "wood_type_uuid"
  },
  "image": "binary_image_data",
  "board_height": 25.0,
  "board_length": 3000.0
}
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤
```http
GET /api/v1/products?limit=20&offset=0

Response:
{
  "data": [
    {
      "id": "uuid",
      "title": "–î–æ—Å–∫–∏ —Å–æ—Å–Ω–æ–≤—ã–µ",
      "price": 15000.0,
      "volume": 0.75,
      "created_at": "2024-01-15T10:30:00Z"
    }
  ],
  "pagination": {
    "total": 45,
    "limit": 20,
    "offset": 0
  }
}
```

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Keycloak –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:
- **Keycloak URL**: `http://localhost:8030`
- **Realm**: –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- **–¢–æ–∫–µ–Ω—ã**: JWT —Ç–æ–∫–µ–Ω—ã –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ `Authorization: Bearer <token>`

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

- **–õ–æ–≥–∏**: —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏ —á–µ—Ä–µ–∑ Loguru
- **–ú–µ—Ç—Ä–∏–∫–∏**: –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ health endpoints
- **–¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞**: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ distributed tracing

---

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ—Å–µ—Ç–∏—Ç–µ `/docs` endpoint –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–∏—Å—Ç–µ–º—ã.
