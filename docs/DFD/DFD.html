<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DFD –î–∏–∞–≥—Ä–∞–º–º—ã - WoodenBoardsShop</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            color: #2563eb;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1rem;
            color: #64748b;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
        }

        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 10px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .tab {
            background: transparent;
            border: none;
            padding: 12px 24px;
            margin: 0 5px;
            border-radius: 10px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #64748b;
        }

        .tab.active {
            background: #2563eb;
            color: white;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        .tab:hover:not(.active) {
            background: #f1f5f9;
            color: #1e293b;
        }

        .diagram-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
            overflow-x: auto;
            display: none;
        }

        .diagram-container.active {
            display: block;
        }

        .diagram-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 20px;
            text-align: center;
        }

        .mermaid {
            text-align: center;
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }

        .controls {
            text-align: center;
            margin-bottom: 20px;
        }

        .btn {
            background: #2563eb;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            margin: 0 10px;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: #1d4ed8;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        .description {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        .description h3 {
            font-size: 1.3rem;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 15px;
        }

        .description-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .description-item {
            background: #f8fafc;
            border-radius: 12px;
            padding: 15px;
            border-left: 4px solid #2563eb;
        }

        .description-item h4 {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 8px;
        }

        .description-item p {
            color: #64748b;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .tabs {
                flex-wrap: wrap;
            }
            
            .tab {
                margin: 5px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîÑ Data Flow Diagrams</h1>
            <p>–î–∏–∞–≥—Ä–∞–º–º—ã –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º—ã WoodenBoardsShop - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–≤–∏–∂–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ –ø—Ä–æ—Ü–µ—Å—Å—ã, —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –∏ –≤–Ω–µ—à–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showDiagram('context')">–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞</button>
            <button class="tab" onclick="showDiagram('level1')">–£—Ä–æ–≤–µ–Ω—å 1</button>
            <button class="tab" onclick="showDiagram('products')">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏</button>
            <button class="tab" onclick="showDiagram('communications')">–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏</button>
        </div>

        <div class="controls">
            <button class="btn" onclick="downloadCurrentDiagram()">üíæ –°–∫–∞—á–∞—Ç—å –¥–∏–∞–≥—Ä–∞–º–º—É</button>
            <button class="btn" onclick="resetZoom()">‚Üª –°–±—Ä–æ—Å–∏—Ç—å –º–∞—Å—à—Ç–∞–±</button>
        </div>

        <!-- –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ -->
        <div id="context" class="diagram-container active">
            <div class="diagram-title">–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ (–£—Ä–æ–≤–µ–Ω—å 0)</div>
            <div class="mermaid">
graph TB
    %% –í–Ω–µ—à–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏
    Buyer[üë§ –ü–æ–∫—É–ø–∞—Ç–µ–ª—å]
    Seller[üè™ –ü—Ä–æ–¥–∞–≤–µ—Ü]
    Admin[üë®‚Äçüíº –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä]
    Keycloak[üîê Keycloak]
    AI[ü§ñ AI –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å]
    
    %% –û—Å–Ω–æ–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
    System[üè¢ WoodenBoardsShop<br/>–°–∏—Å—Ç–µ–º–∞ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞]
    
    %% –ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö
    Buyer -->|–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤<br/>–°–æ–æ–±—â–µ–Ω–∏—è| System
    System -->|–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤<br/>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞| Buyer
    
    Seller -->|–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏<br/>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ—Å–æ–∫<br/>–°–æ–æ–±—â–µ–Ω–∏—è| System
    System -->|–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–¥–∞–∂<br/>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è| Seller
    
    Admin -->|–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–æ–π<br/>–ú–æ–¥–µ—Ä–∞—Ü–∏—è| System
    System -->|–û—Ç—á–µ—Ç—ã<br/>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞| Admin
    
    System <-->|–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è<br/>–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è| Keycloak
    System <-->|–ê–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π<br/>–†–∞–∑–º–µ—Ä—ã –¥–æ—Å–æ–∫| AI
    
    %% –°—Ç–∏–ª–∏
    classDef external fill:#e1f5fe,stroke:#0277bd,stroke-width:2px
    classDef system fill:#f3e5f5,stroke:#7b1fa2,stroke-width:3px
    
    class Buyer,Seller,Admin,Keycloak,AI external
    class System system
            </div>
            
            <div class="description">
                <h3>üìù –û–ø–∏—Å–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–π –¥–∏–∞–≥—Ä–∞–º–º—ã</h3>
                <div class="description-grid">
                    <div class="description-item">
                        <h4>üë§ –ü–æ–∫—É–ø–∞—Ç–µ–ª–∏</h4>
                        <p>–ò—â—É—Ç –∏ –ø–æ–∫—É–ø–∞—é—Ç —Ç–æ–≤–∞—Ä—ã –∏–∑ –¥—Ä–µ–≤–µ—Å–∏–Ω—ã, –æ–±—â–∞—é—Ç—Å—è —Å –ø—Ä–æ–¥–∞–≤—Ü–∞–º–∏ —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É —á–∞—Ç–æ–≤</p>
                    </div>
                    <div class="description-item">
                        <h4>üè™ –ü—Ä–æ–¥–∞–≤—Ü—ã</h4>
                        <p>–£–ø—Ä–∞–≤–ª—è—é—Ç —Ç–æ–≤–∞—Ä–∞–º–∏, –∑–∞–≥—Ä—É–∂–∞—é—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞, –æ–±—â–∞—é—Ç—Å—è —Å –ø–æ–∫—É–ø–∞—Ç–µ–ª—è–º–∏</p>
                    </div>
                    <div class="description-item">
                        <h4>üë®‚Äçüíº –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã</h4>
                        <p>–£–ø—Ä–∞–≤–ª—è—é—Ç —Å–∏—Å—Ç–µ–º–æ–π, –º–æ–¥–µ—Ä–∏—Ä—É—é—Ç –∫–æ–Ω—Ç–µ–Ω—Ç, –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</p>
                    </div>
                    <div class="description-item">
                        <h4>üîê Keycloak</h4>
                        <p>–°–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</p>
                    </div>
                    <div class="description-item">
                        <h4>ü§ñ AI –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å</h4>
                        <p>–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ—Å–æ–∫, –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–∞–∑–º–µ—Ä—ã –∏ –æ–±—ä–µ–º—ã</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- –î–∏–∞–≥—Ä–∞–º–º–∞ —É—Ä–æ–≤–Ω—è 1 -->
        <div id="level1" class="diagram-container">
            <div class="diagram-title">–î–∏–∞–≥—Ä–∞–º–º–∞ —É—Ä–æ–≤–Ω—è 1 - –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã</div>
            <div class="mermaid">
graph TB
    %% –í–Ω–µ—à–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏
    Buyer[üë§ –ü–æ–∫—É–ø–∞—Ç–µ–ª—å]
    Seller[üè™ –ü—Ä–æ–¥–∞–≤–µ—Ü]
    Admin[üë®‚Äçüíº –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä]
    Keycloak[üîê Keycloak]
    AI[ü§ñ AI –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å]
    
    %% –ü—Ä–æ—Ü–µ—Å—Å—ã
    P1[1.0<br/>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ<br/>–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏]
    P2[2.0<br/>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ<br/>–∫–∞—Ç–∞–ª–æ–≥–æ–º –¥—Ä–µ–≤–µ—Å–∏–Ω—ã]
    P3[3.0<br/>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ<br/>—Ç–æ–≤–∞—Ä–∞–º–∏]
    P4[4.0<br/>–ê–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π<br/>–¥–æ—Å–æ–∫]
    P5[5.0<br/>–°–∏—Å—Ç–µ–º–∞<br/>–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π]
    P6[6.0<br/>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ]
    
    %% –•—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö
    D1[(D1<br/>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)]
    D2[(D2<br/>–ö–∞—Ç–∞–ª–æ–≥<br/>–¥—Ä–µ–≤–µ—Å–∏–Ω—ã)]
    D3[(D3<br/>–¢–æ–≤–∞—Ä—ã)]
    D4[(D4<br/>–ê–Ω–∞–ª–∏–∑<br/>–¥–æ—Å–æ–∫)]
    D5[(D5<br/>–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏)]
    
    %% –ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö
    Keycloak -->|–î–∞–Ω–Ω—ã–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏| P1
    P1 -->|–ü—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π| D1
    D1 -->|–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π| P1
    
    Admin -->|–¢–∏–ø—ã –¥—Ä–µ–≤–µ—Å–∏–Ω—ã, —Ü–µ–Ω—ã| P2
    P2 -->|–ö–∞—Ç–∞–ª–æ–≥ –¥—Ä–µ–≤–µ—Å–∏–Ω—ã| D2
    D2 -->|–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏| P2
    
    Seller -->|–î–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä–æ–≤| P3
    P3 -->|–¢–æ–≤–∞—Ä—ã| D3
    D3 -->|–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤| P3
    P3 -->|–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞| Buyer
    
    Seller -->|–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ—Å–æ–∫| P4
    P4 <-->|–ê–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π| AI
    P4 -->|–†–∞–∑–º–µ—Ä—ã –¥–æ—Å–æ–∫| D4
    D4 -->|–î–∞–Ω–Ω—ã–µ –∞–Ω–∞–ª–∏–∑–∞| P4
    
    Buyer -->|–°–æ–æ–±—â–µ–Ω–∏—è| P5
    Seller -->|–°–æ–æ–±—â–µ–Ω–∏—è| P5
    P5 -->|–ß–∞—Ç—ã| D5
    D5 -->|–ò—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π| P5
    
    Admin -->|–ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è| P6
    P6 -->|–û—Ç—á–µ—Ç—ã, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞| Admin
    D1 -.->|–ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö| P6
    D2 -.->|–ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö| P6
    D3 -.->|–ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö| P6
    D4 -.->|–ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö| P6
    D5 -.->|–ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö| P6
    
    %% –°—Ç–∏–ª–∏
    classDef external fill:#e1f5fe,stroke:#0277bd,stroke-width:2px
    classDef process fill:#fff3e0,stroke:#f57c00,stroke-width:2px
    classDef datastore fill:#e8f5e8,stroke:#388e3c,stroke-width:2px
    
    class Buyer,Seller,Admin,Keycloak,AI external
    class P1,P2,P3,P4,P5,P6 process
    class D1,D2,D3,D4,D5 datastore
            </div>
        </div>

        <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏ -->
        <div id="products" class="diagram-container">
            <div class="diagram-title">–£—Ä–æ–≤–µ–Ω—å 2 - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏</div>
            <div class="mermaid">
graph TB
    %% –í–Ω–µ—à–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏
    Seller[üè™ –ü—Ä–æ–¥–∞–≤–µ—Ü]
    Buyer[üë§ –ü–æ–∫—É–ø–∞—Ç–µ–ª—å]
    AI[ü§ñ AI –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å]
    
    %% –ü–æ–¥–ø—Ä–æ—Ü–µ—Å—Å—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞–º–∏
    P31[3.1<br/>–°–æ–∑–¥–∞–Ω–∏–µ<br/>—Ç–æ–≤–∞—Ä–∞]
    P32[3.2<br/>–ó–∞–≥—Ä—É–∑–∫–∞<br/>–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π]
    P33[3.3<br/>–ê–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π<br/>–¥–æ—Å–æ–∫]
    P34[3.4<br/>–ü–æ–∏—Å–∫<br/>—Ç–æ–≤–∞—Ä–æ–≤]
    P35[3.5<br/>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ<br/>—Ç–æ–≤–∞—Ä–∞]
    P36[3.6<br/>–£–¥–∞–ª–µ–Ω–∏–µ<br/>—Ç–æ–≤–∞—Ä–∞]
    
    %% –•—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö
    D3[(D3<br/>–¢–æ–≤–∞—Ä—ã)]
    D31[(D3.1<br/>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)]
    D32[(D3.2<br/>–ê–Ω–∞–ª–∏–∑ –¥–æ—Å–æ–∫)]
    D2[(D2<br/>–¢–∏–ø—ã –¥—Ä–µ–≤–µ—Å–∏–Ω—ã)]
    
    %% –ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞
    Seller -->|–î–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä–∞| P31
    P31 -->|–ù–æ–≤—ã–π —Ç–æ–≤–∞—Ä| D3
    D2 -->|–¢–∏–ø—ã –¥—Ä–µ–≤–µ—Å–∏–Ω—ã| P31
    
    %% –ü–æ—Ç–æ–∫–∏ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    Seller -->|–§–∞–π–ª—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π| P32
    P32 -->|–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π| D31
    D31 -->|–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞| P32
    
    %% –ü–æ—Ç–æ–∫–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
    P32 -->|–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ—Å–∫–∏| P33
    Seller -->|–†–∞–∑–º–µ—Ä—ã (–≤—ã—Å–æ—Ç–∞, –¥–ª–∏–Ω–∞)| P33
    P33 <-->|–ó–∞–ø—Ä–æ—Å/—Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞| AI
    P33 -->|–†–∞–∑–º–µ—Ä—ã –¥–æ—Å–æ–∫| D32
    
    %% –ü–æ—Ç–æ–∫–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞
    Buyer -->|–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø–æ–∏—Å–∫–∞| P34
    D3 -->|–î–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä–æ–≤| P34
    D2 -->|–§–∏–ª—å—Ç—Ä—ã –ø–æ —Ç–∏–ø—É| P34
    P34 -->|–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞| Buyer
    
    %% –ü–æ—Ç–æ–∫–∏ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
    Seller -->|–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ| P35
    D3 <-->|–ß—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å| P35
    
    %% –ü–æ—Ç–æ–∫–∏ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
    Seller -->|ID —Ç–æ–≤–∞—Ä–∞| P36
    P36 -->|–£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏| D3
    P36 -->|–ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ| D31
    P36 -->|–ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ| D32
    
    %% –°—Ç–∏–ª–∏
    classDef external fill:#e1f5fe,stroke:#0277bd,stroke-width:2px
    classDef process fill:#fff3e0,stroke:#f57c00,stroke-width:2px
    classDef datastore fill:#e8f5e8,stroke:#388e3c,stroke-width:2px
    
    class Seller,Buyer,AI external
    class P31,P32,P33,P34,P35,P36 process
    class D3,D31,D32,D2 datastore
            </div>
        </div>

        <!-- –°–∏—Å—Ç–µ–º–∞ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π -->
        <div id="communications" class="diagram-container">
            <div class="diagram-title">–£—Ä–æ–≤–µ–Ω—å 2 - –°–∏—Å—Ç–µ–º–∞ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π</div>
            <div class="mermaid">
graph TB
    %% –í–Ω–µ—à–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏
    Buyer[üë§ –ü–æ–∫—É–ø–∞—Ç–µ–ª—å]
    Seller[üè™ –ü—Ä–æ–¥–∞–≤–µ—Ü]
    
    %% –ü–æ–¥–ø—Ä–æ—Ü–µ—Å—Å—ã –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π
    P51[5.1<br/>–°–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–µ–¥–∞<br/>–æ–±—â–µ–Ω–∏—è]
    P52[5.2<br/>–û—Ç–ø—Ä–∞–≤–∫–∞<br/>—Å–æ–æ–±—â–µ–Ω–∏—è]
    P53[5.3<br/>–ü–æ–ª—É—á–µ–Ω–∏–µ<br/>—Å–æ–æ–±—â–µ–Ω–∏–π]
    P54[5.4<br/>–û—Ç–º–µ—Ç–∫–∞<br/>–ø—Ä–æ—á—Ç–µ–Ω–∏—è]
    P55[5.5<br/>–ü–æ–ª—É—á–µ–Ω–∏–µ<br/>—Å–ø–∏—Å–∫–∞ —Ç—Ä–µ–¥–æ–≤]
    
    %% –•—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö
    D51[(D5.1<br/>–¢—Ä–µ–¥—ã —á–∞—Ç–æ–≤)]
    D52[(D5.2<br/>–°–æ–æ–±—â–µ–Ω–∏—è)]
    D1[(D1<br/>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)]
    
    %% –ü–æ—Ç–æ–∫–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç—Ä–µ–¥–∞
    Buyer -->|–ó–∞–ø—Ä–æ—Å –Ω–∞ –æ–±—â–µ–Ω–∏–µ| P51
    Seller -->|–°–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –æ–±—â–µ–Ω–∏–µ| P51
    D1 -->|–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π| P51
    P51 -->|–ù–æ–≤—ã–π —Ç—Ä–µ–¥| D51
    
    %% –ü–æ—Ç–æ–∫–∏ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
    Buyer -->|–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è| P52
    Seller -->|–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è| P52
    D51 -->|–í–∞–ª–∏–¥–∞—Ü–∏—è —Ç—Ä–µ–¥–∞| P52
    P52 -->|–ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ| D52
    
    %% –ü–æ—Ç–æ–∫–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
    Buyer -->|–ó–∞–ø—Ä–æ—Å —Å–æ–æ–±—â–µ–Ω–∏–π| P53
    Seller -->|–ó–∞–ø—Ä–æ—Å —Å–æ–æ–±—â–µ–Ω–∏–π| P53
    D52 -->|–ò—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π| P53
    P53 -->|–°–ø–∏—Å–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π| Buyer
    P53 -->|–°–ø–∏—Å–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π| Seller
    
    %% –ü–æ—Ç–æ–∫–∏ –¥–ª—è –æ—Ç–º–µ—Ç–∫–∏ –ø—Ä–æ—á—Ç–µ–Ω–∏—è
    Buyer -->|–û—Ç–º–µ—Ç–∫–∞ –ø—Ä–æ—á—Ç–µ–Ω–∏—è| P54
    Seller -->|–û—Ç–º–µ—Ç–∫–∞ –ø—Ä–æ—á—Ç–µ–Ω–∏—è| P54
    P54 <-->|–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–ª–∞–≥–æ–≤| D52
    
    %% –ü–æ—Ç–æ–∫–∏ –¥–ª—è —Å–ø–∏—Å–∫–∞ —Ç—Ä–µ–¥–æ–≤
    Buyer -->|–ó–∞–ø—Ä–æ—Å —Ç—Ä–µ–¥–æ–≤| P55
    Seller -->|–ó–∞–ø—Ä–æ—Å —Ç—Ä–µ–¥–æ–≤| P55
    D51 -->|–°–ø–∏—Å–æ–∫ —Ç—Ä–µ–¥–æ–≤| P55
    D52 -->|–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è| P55
    P55 -->|–¢—Ä–µ–¥—ã —Å –ø—Ä–µ–≤—å—é| Buyer
    P55 -->|–¢—Ä–µ–¥—ã —Å –ø—Ä–µ–≤—å—é| Seller
    
    %% –°—Ç–∏–ª–∏
    classDef external fill:#e1f5fe,stroke:#0277bd,stroke-width:2px
    classDef process fill:#fff3e0,stroke:#f57c00,stroke-width:2px
    classDef datastore fill:#e8f5e8,stroke:#388e3c,stroke-width:2px
    
    class Buyer,Seller external
    class P51,P52,P53,P54,P55 process
    class D51,D52,D1 datastore
            </div>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Mermaid
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            themeVariables: {
                primaryColor: '#2563eb',
                primaryTextColor: '#1e293b',
                primaryBorderColor: '#3b82f6',
                lineColor: '#64748b',
                sectionBkgColor: '#f8fafc',
                altSectionBkgColor: '#e2e8f0',
                gridColor: '#cbd5e1',
                secondaryColor: '#f1f5f9',
                tertiaryColor: '#f8fafc'
            },
            flowchart: {
                diagramPadding: 20,
                htmlLabels: true,
                curve: 'basis'
            }
        });

        function showDiagram(diagramId) {
            // –°–∫—Ä—ã—Ç—å –≤—Å–µ –¥–∏–∞–≥—Ä–∞–º–º—ã
            const diagrams = document.querySelectorAll('.diagram-container');
            diagrams.forEach(diagram => diagram.classList.remove('active'));
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –¥–∏–∞–≥—Ä–∞–º–º—É
            document.getElementById(diagramId).classList.add('active');
            
            // –û–±–Ω–æ–≤–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—É—é –≤–∫–ª–∞–¥–∫—É
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');
        }

        function resetZoom() {
            const activeDiagram = document.querySelector('.diagram-container.active .mermaid svg');
            if (activeDiagram) {
                activeDiagram.style.transform = 'scale(1)';
                activeDiagram.style.transformOrigin = 'center top';
            }
        }

        function downloadCurrentDiagram() {
            const activeDiagram = document.querySelector('.diagram-container.active .mermaid svg');
            if (activeDiagram) {
                const svgData = new XMLSerializer().serializeToString(activeDiagram);
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                const img = new Image();
                
                img.onload = function() {
                    canvas.width = img.width;
                    canvas.height = img.height;
                    ctx.fillStyle = 'white';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    ctx.drawImage(img, 0, 0);
                    
                    const activeContainer = document.querySelector('.diagram-container.active');
                    const title = activeContainer.querySelector('.diagram-title').textContent;
                    const filename = `WoodenBoardsShop_DFD_${title.replace(/\s+/g, '_')}.png`;
                    
                    const link = document.createElement('a');
                    link.download = filename;
                    link.href = canvas.toDataURL();
                    link.click();
                };
                
                img.src = 'data:image/svg+xml;base64,' + btoa(unescape(encodeURIComponent(svgData)));
            }
        }

        // –î–æ–±–∞–≤–ª—è–µ–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∏–∞–≥—Ä–∞–º–º –∫–æ–ª–µ—Å–∏–∫–æ–º –º—ã—à–∏
        document.addEventListener('wheel', function(e) {
            if (e.ctrlKey) {
                e.preventDefault();
                const activeDiagram = document.querySelector('.diagram-container.active .mermaid svg');
                if (activeDiagram) {
                    const currentScale = activeDiagram.style.transform.match(/scale\(([^)]+)\)/);
                    let scale = currentScale ? parseFloat(currentScale[1]) : 1;

                    scale += e.deltaY > 0 ? -0.1 : 0.1;
                    scale = Math.max(0.5, Math.min(3, scale));

                    activeDiagram.style.transform = `scale(${scale})`;
                    activeDiagram.style.transformOrigin = 'center top';
                }
            }
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
        setTimeout(() => {
            resetZoom();
        }, 1000);
    </script>
</body>
</html>
