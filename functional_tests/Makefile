# Makefile Ğ´Ğ»Ñ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ñ… Ñ‚ĞµÑÑ‚Ğ¾Ğ²

.PHONY: help build rebuild up down test test-rebuild test-api test-api-rebuild test-browser test-integration test-uuid test-uuid-rebuild test-uuid-validation test-uuid-integration selenium-diagnostics selenium-status selenium-fix selenium-fix-docker selenium-fix-local selenium-restart clean logs shell

# ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ
COMPOSE_FILE = docker-compose.test.yaml
PROJECT_NAME = diplom-functional-tests

# Ğ¦Ğ²ĞµÑ‚Ğ° Ğ´Ğ»Ñ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ°
GREEN = \033[0;32m
YELLOW = \033[1;33m
RED = \033[0;31m
NC = \033[0m # No Color

help: ## ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ ÑĞ¿Ñ€Ğ°Ğ²ĞºÑƒ
	@echo "$(GREEN)Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ñ‚ĞµÑÑ‚Ñ‹ - Diplom Project$(NC)"
	@echo ""
	@echo "$(YELLOW)Ğ”Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹:$(NC)"
	@awk 'BEGIN {FS = ":.*?## "} /^[a-zA-Z_-]+:.*?## / {printf "  $(GREEN)%-20s$(NC) %s\n", $$1, $$2}' $(MAKEFILE_LIST)

build: ## Ğ¡Ğ¾Ğ±Ñ€Ğ°Ñ‚ÑŒ Docker Ğ¾Ğ±Ñ€Ğ°Ğ·Ñ‹ Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ¾Ğ²
	@echo "$(YELLOW)ğŸ—ï¸  Ğ¡Ğ±Ğ¾Ñ€ĞºĞ° Docker Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ² Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ¾Ğ²...$(NC)"
	docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) build

rebuild: ## ĞŸĞµÑ€ĞµÑĞ¾Ğ±Ñ€Ğ°Ñ‚ÑŒ Docker Ğ¾Ğ±Ñ€Ğ°Ğ·Ñ‹ Ñ Ğ¾Ñ‡Ğ¸ÑÑ‚ĞºĞ¾Ğ¹ ĞºÑÑˆĞ°
	@echo "$(YELLOW)ğŸ”„ ĞŸĞµÑ€ĞµÑĞ±Ğ¾Ñ€ĞºĞ° Docker Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ² Ñ Ğ¾Ñ‡Ğ¸ÑÑ‚ĞºĞ¾Ğ¹ ĞºÑÑˆĞ°...$(NC)"
	docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) build --no-cache

up: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğµ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ğµ
	@echo "$(YELLOW)ğŸš€ Ğ—Ğ°Ğ¿ÑƒÑĞº Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ...$(NC)"
	docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) up -d

down: ## ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğµ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ğµ
	@echo "$(YELLOW)ğŸ›‘ ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ...$(NC)"
	docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) down

test: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ğ²ÑĞµ Ñ‚ĞµÑÑ‚Ñ‹
	@echo "$(YELLOW)ğŸ§ª Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ²ÑĞµÑ… Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ñ… Ñ‚ĞµÑÑ‚Ğ¾Ğ²...$(NC)"
	TEST_TYPE=all docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) up --build --abort-on-container-exit
	@$(MAKE) down

test-rebuild: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ğ²ÑĞµ Ñ‚ĞµÑÑ‚Ñ‹ Ñ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğ¹ Ğ¿ĞµÑ€ĞµÑĞ±Ğ¾Ñ€ĞºĞ¾Ğ¹
	@echo "$(YELLOW)ğŸ”„ Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ²ÑĞµÑ… Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ñ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğ¹ Ğ¿ĞµÑ€ĞµÑĞ±Ğ¾Ñ€ĞºĞ¾Ğ¹...$(NC)"
	@$(MAKE) rebuild
	TEST_TYPE=all docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) up --abort-on-container-exit
	@$(MAKE) down

test-api: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ API Ñ‚ĞµÑÑ‚Ñ‹
	@echo "$(YELLOW)ğŸ”Œ Ğ—Ğ°Ğ¿ÑƒÑĞº API Ñ‚ĞµÑÑ‚Ğ¾Ğ²...$(NC)"
	TEST_TYPE=api docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) up --build --abort-on-container-exit
	@$(MAKE) down

test-browser: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğ½Ñ‹Ğµ Ñ‚ĞµÑÑ‚Ñ‹
	@echo "$(YELLOW)ğŸŒ Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğ½Ñ‹Ñ… Ñ‚ĞµÑÑ‚Ğ¾Ğ²...$(NC)"
	TEST_TYPE=browser docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) up --build --abort-on-container-exit
	@$(MAKE) down

test-integration: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ğµ Ñ‚ĞµÑÑ‚Ñ‹
	@echo "$(YELLOW)ğŸ”— Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ñ… Ñ‚ĞµÑÑ‚Ğ¾Ğ²...$(NC)"
	TEST_TYPE=integration docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) up --build --abort-on-container-exit
	@$(MAKE) down

test-local: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ñ‚ĞµÑÑ‚Ñ‹ Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾ (Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ñ‹Ñ… Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹)
	@echo "$(YELLOW)ğŸ’» Ğ—Ğ°Ğ¿ÑƒÑĞº Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾...$(NC)"
	pytest -v --html=reports/local_tests_report.html --self-contained-html

test-api-local: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ API Ñ‚ĞµÑÑ‚Ñ‹ Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾
	@echo "$(YELLOW)ğŸ”Œ Ğ—Ğ°Ğ¿ÑƒÑĞº API Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾...$(NC)"
	pytest api_tests/ -v --html=reports/api_tests_local_report.html --self-contained-html

test-api-buyer: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ API Ñ‚ĞµÑÑ‚Ñ‹ Ğ´Ğ»Ñ buyer
	@echo "$(YELLOW)ğŸ‘¤ Ğ—Ğ°Ğ¿ÑƒÑĞº API Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ğ´Ğ»Ñ buyer...$(NC)"
	TEST_TYPE=api PYTEST_ARGS="-v api_tests/buyer/" docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) up --build --abort-on-container-exit
	@$(MAKE) down

test-api-wood-type: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ API Ñ‚ĞµÑÑ‚Ñ‹ Ğ´Ğ»Ñ wood_type
	@echo "$(YELLOW)ğŸŒ³ Ğ—Ğ°Ğ¿ÑƒÑĞº API Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ğ´Ğ»Ñ wood_type...$(NC)"
	TEST_TYPE=api PYTEST_ARGS="-v api_tests/wood_type/" docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) up --build --abort-on-container-exit
	@$(MAKE) down

test-api-crud: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ CRUD API Ñ‚ĞµÑÑ‚Ñ‹
	@echo "$(YELLOW)ğŸ“ Ğ—Ğ°Ğ¿ÑƒÑĞº CRUD API Ñ‚ĞµÑÑ‚Ğ¾Ğ²...$(NC)"
	TEST_TYPE=api PYTEST_ARGS="-v -m crud api_tests/" docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) up --build --abort-on-container-exit
	@$(MAKE) down

test-api-validation: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ğµ API Ñ‚ĞµÑÑ‚Ñ‹
	@echo "$(YELLOW)âœ… Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ñ… API Ñ‚ĞµÑÑ‚Ğ¾Ğ²...$(NC)"
	TEST_TYPE=api PYTEST_ARGS="-v -m validation api_tests/" docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) up --build --abort-on-container-exit
	@$(MAKE) down

test-api-seller: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ API Ñ‚ĞµÑÑ‚Ñ‹ Ğ´Ğ»Ñ seller
	@echo "$(YELLOW)ğŸª Ğ—Ğ°Ğ¿ÑƒÑĞº API Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ğ´Ğ»Ñ seller...$(NC)"
	TEST_TYPE=api PYTEST_ARGS="-v api_tests/seller/" docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) up --build --abort-on-container-exit
	@$(MAKE) down

test-api-product: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ API Ñ‚ĞµÑÑ‚Ñ‹ Ğ´Ğ»Ñ product
	@echo "$(YELLOW)ğŸ“¦ Ğ—Ğ°Ğ¿ÑƒÑĞº API Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ğ´Ğ»Ñ product...$(NC)"
	TEST_TYPE=api PYTEST_ARGS="-v api_tests/product/" docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) up --build --abort-on-container-exit
	@$(MAKE) down

test-api-wooden-board: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ API Ñ‚ĞµÑÑ‚Ñ‹ Ğ´Ğ»Ñ wooden_board
	@echo "$(YELLOW)ğŸªµ Ğ—Ğ°Ğ¿ÑƒÑĞº API Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ğ´Ğ»Ñ wooden_board...$(NC)"
	TEST_TYPE=api PYTEST_ARGS="-v api_tests/wooden_board/" docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) up --build --abort-on-container-exit
	@$(MAKE) down

test-api-image: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ API Ñ‚ĞµÑÑ‚Ñ‹ Ğ´Ğ»Ñ image
	@echo "$(YELLOW)ğŸ–¼ï¸  Ğ—Ğ°Ğ¿ÑƒÑĞº API Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ğ´Ğ»Ñ image...$(NC)"
	TEST_TYPE=api PYTEST_ARGS="-v api_tests/image/" docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) up --build --abort-on-container-exit
	@$(MAKE) down

test-api-chat: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ API Ñ‚ĞµÑÑ‚Ñ‹ Ğ´Ğ»Ñ chat
	@echo "$(YELLOW)ğŸ’¬ Ğ—Ğ°Ğ¿ÑƒÑĞº API Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ğ´Ğ»Ñ chat...$(NC)"
	TEST_TYPE=api PYTEST_ARGS="-v api_tests/chat/" docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) up --build --abort-on-container-exit
	@$(MAKE) down

test-api-get-by-id: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ñ‚ĞµÑÑ‚Ñ‹ GET by ID
	@echo "$(YELLOW)ğŸ” Ğ—Ğ°Ğ¿ÑƒÑĞº Ñ‚ĞµÑÑ‚Ğ¾Ğ² GET by ID...$(NC)"
	TEST_TYPE=api PYTEST_ARGS="-v api_tests/test_get_by_id.py" docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) up --build --abort-on-container-exit
	@$(MAKE) down

test-api-patch: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ñ‚ĞµÑÑ‚Ñ‹ PATCH Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹
	@echo "$(YELLOW)âœï¸  Ğ—Ğ°Ğ¿ÑƒÑĞº Ñ‚ĞµÑÑ‚Ğ¾Ğ² PATCH Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹...$(NC)"
	TEST_TYPE=api PYTEST_ARGS="-v api_tests/test_patch_operations.py" docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) up --build --abort-on-container-exit
	@$(MAKE) down

test-api-delete: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ñ‚ĞµÑÑ‚Ñ‹ DELETE Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹
	@echo "$(YELLOW)ğŸ—‘ï¸  Ğ—Ğ°Ğ¿ÑƒÑĞº Ñ‚ĞµÑÑ‚Ğ¾Ğ² DELETE Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹...$(NC)"
	TEST_TYPE=api PYTEST_ARGS="-v api_tests/test_delete_operations.py" docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) up --build --abort-on-container-exit
	@$(MAKE) down

test-api-wood-type-price: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ñ‚ĞµÑÑ‚Ñ‹ wood-type-price API
	@echo "$(YELLOW)ğŸ’° Ğ—Ğ°Ğ¿ÑƒÑĞº Ñ‚ĞµÑÑ‚Ğ¾Ğ² wood-type-price API...$(NC)"
	TEST_TYPE=api PYTEST_ARGS="-v api_tests/wood_type_price/" docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) up --build --abort-on-container-exit
	@$(MAKE) down

test-api-calculate-volume: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ñ‚ĞµÑÑ‚Ñ‹ Ñ€Ğ°ÑÑ‡ĞµÑ‚Ğ° Ğ¾Ğ±ÑŠĞµĞ¼Ğ°
	@echo "$(YELLOW)ğŸ“ Ğ—Ğ°Ğ¿ÑƒÑĞº Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ñ€Ğ°ÑÑ‡ĞµÑ‚Ğ° Ğ¾Ğ±ÑŠĞµĞ¼Ğ°...$(NC)"
	TEST_TYPE=api PYTEST_ARGS="-v api_tests/wooden_board/test_calculate_volume.py" docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) up --build --abort-on-container-exit
	@$(MAKE) down

test-api-comprehensive: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ ĞºĞ¾Ğ¼Ğ¿Ğ»ĞµĞºÑĞ½Ñ‹Ğµ API Ñ‚ĞµÑÑ‚Ñ‹
	@echo "$(YELLOW)ğŸ¯ Ğ—Ğ°Ğ¿ÑƒÑĞº ĞºĞ¾Ğ¼Ğ¿Ğ»ĞµĞºÑĞ½Ñ‹Ñ… API Ñ‚ĞµÑÑ‚Ğ¾Ğ²...$(NC)"
	TEST_TYPE=api PYTEST_ARGS="-v api_tests/test_comprehensive_suite.py" docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) up --build --abort-on-container-exit
	@$(MAKE) down

test-api-smoke: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ smoke Ñ‚ĞµÑÑ‚Ñ‹ API
	@echo "$(YELLOW)ğŸ’¨ Ğ—Ğ°Ğ¿ÑƒÑĞº smoke Ñ‚ĞµÑÑ‚Ğ¾Ğ² API...$(NC)"
	TEST_TYPE=api PYTEST_ARGS="-v -m smoke api_tests/" docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) up --build --abort-on-container-exit
	@$(MAKE) down

test-api-stress: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ ÑÑ‚Ñ€ĞµÑÑ Ñ‚ĞµÑÑ‚Ñ‹ API
	@echo "$(YELLOW)âš¡ Ğ—Ğ°Ğ¿ÑƒÑĞº ÑÑ‚Ñ€ĞµÑÑ Ñ‚ĞµÑÑ‚Ğ¾Ğ² API...$(NC)"
	TEST_TYPE=api PYTEST_ARGS="-v -m stress api_tests/" docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) up --build --abort-on-container-exit
	@$(MAKE) down

test-api-integration: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ğµ API Ñ‚ĞµÑÑ‚Ñ‹
	@echo "$(YELLOW)ğŸ”— Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ñ… API Ñ‚ĞµÑÑ‚Ğ¾Ğ²...$(NC)"
	TEST_TYPE=api PYTEST_ARGS="-v -m integration api_tests/" docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) up --build --abort-on-container-exit
	@$(MAKE) down

test-api-workflow: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ñ‚ĞµÑÑ‚Ñ‹ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğ³Ğ¾ workflow
	@echo "$(YELLOW)ğŸ”„ Ğ—Ğ°Ğ¿ÑƒÑĞº Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğ³Ğ¾ workflow...$(NC)"
	TEST_TYPE=api PYTEST_ARGS="-v api_tests/test_integration_workflow.py" docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) up --build --abort-on-container-exit
	@$(MAKE) down

test-browser-local: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğ½Ñ‹Ğµ Ñ‚ĞµÑÑ‚Ñ‹ Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾
	@echo "$(YELLOW)ğŸŒ Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğ½Ñ‹Ñ… Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾...$(NC)"
	pytest browser_tests/ -v --html=reports/browser_tests_local_report.html --self-contained-html

test-integration-local: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ğµ Ñ‚ĞµÑÑ‚Ñ‹ Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾
	@echo "$(YELLOW)ğŸ”— Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ñ… Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾...$(NC)"
	pytest integration_tests/ -v --html=reports/integration_tests_local_report.html --self-contained-html

test-uuid: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ UUID Ñ‚ĞµÑÑ‚Ñ‹
	@echo "$(YELLOW)ğŸ†” Ğ—Ğ°Ğ¿ÑƒÑĞº UUID Ñ‚ĞµÑÑ‚Ğ¾Ğ²...$(NC)"
	TEST_TYPE=api PYTEST_ARGS="-v -k uuid" docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) up --build --abort-on-container-exit
	@$(MAKE) down

test-uuid-local: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ UUID Ñ‚ĞµÑÑ‚Ñ‹ Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾
	@echo "$(YELLOW)ğŸ†” Ğ—Ğ°Ğ¿ÑƒÑĞº UUID Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾...$(NC)"
	pytest -v -k uuid --html=reports/uuid_tests_local_report.html --self-contained-html

test-uuid-validation: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ñ‚ĞµÑÑ‚Ñ‹ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¸ UUID
	@echo "$(YELLOW)âœ… Ğ—Ğ°Ğ¿ÑƒÑĞº Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¸ UUID...$(NC)"
	pytest api_tests/test_uuid_validation.py -v --html=reports/uuid_validation_report.html --self-contained-html

test-uuid-integration: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ğµ UUID Ñ‚ĞµÑÑ‚Ñ‹
	@echo "$(YELLOW)ğŸ”— Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ñ… UUID Ñ‚ĞµÑÑ‚Ğ¾Ğ²...$(NC)"
	pytest integration_tests/test_uuid_integration.py -v --html=reports/uuid_integration_report.html --self-contained-html

test-uuid-rebuild: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ UUID Ñ‚ĞµÑÑ‚Ñ‹ Ñ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğ¹ Ğ¿ĞµÑ€ĞµÑĞ±Ğ¾Ñ€ĞºĞ¾Ğ¹
	@echo "$(YELLOW)ğŸ”„ Ğ—Ğ°Ğ¿ÑƒÑĞº UUID Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ñ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğ¹ Ğ¿ĞµÑ€ĞµÑĞ±Ğ¾Ñ€ĞºĞ¾Ğ¹...$(NC)"
	@$(MAKE) rebuild
	TEST_TYPE=api PYTEST_ARGS="-v -k uuid" docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) up --abort-on-container-exit
	@$(MAKE) down

test-api-rebuild: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ API Ñ‚ĞµÑÑ‚Ñ‹ Ñ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğ¹ Ğ¿ĞµÑ€ĞµÑĞ±Ğ¾Ñ€ĞºĞ¾Ğ¹
	@echo "$(YELLOW)ğŸ”„ Ğ—Ğ°Ğ¿ÑƒÑĞº API Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ñ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğ¹ Ğ¿ĞµÑ€ĞµÑĞ±Ğ¾Ñ€ĞºĞ¾Ğ¹...$(NC)"
	@$(MAKE) rebuild
	TEST_TYPE=api docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) up --abort-on-container-exit
	@$(MAKE) down

clean: ## ĞÑ‡Ğ¸ÑÑ‚Ğ¸Ñ‚ÑŒ Docker Ñ€ĞµÑÑƒÑ€ÑÑ‹ Ğ¸ Ğ¾Ñ‚Ñ‡ĞµÑ‚Ñ‹
	@echo "$(YELLOW)ğŸ§¹ ĞÑ‡Ğ¸ÑÑ‚ĞºĞ° Docker Ñ€ĞµÑÑƒÑ€ÑĞ¾Ğ²...$(NC)"
	docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) down -v --remove-orphans
	docker system prune -f
	@echo "$(YELLOW)ğŸ—‘ï¸  ĞÑ‡Ğ¸ÑÑ‚ĞºĞ° Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ¾Ğ², ÑĞºÑ€Ğ¸Ğ½ÑˆĞ¾Ñ‚Ğ¾Ğ² Ğ¸ Ğ»Ğ¾Ğ³Ğ¾Ğ²...$(NC)"
	rm -rf reports/* screenshots/* logs/*
	@echo "$(GREEN)âœ… ĞÑ‡Ğ¸ÑÑ‚ĞºĞ° Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ°$(NC)"

clean-logs: ## ĞÑ‡Ğ¸ÑÑ‚Ğ¸Ñ‚ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ»Ğ¾Ğ³Ğ¸ Ñ‚ĞµÑÑ‚Ğ¾Ğ²
	@echo "$(YELLOW)ğŸ—‘ï¸  ĞÑ‡Ğ¸ÑÑ‚ĞºĞ° Ğ»Ğ¾Ğ³Ğ¾Ğ² Ñ‚ĞµÑÑ‚Ğ¾Ğ²...$(NC)"
	rm -rf logs/*
	@echo "$(GREEN)âœ… Ğ›Ğ¾Ğ³Ğ¸ Ğ¾Ñ‡Ğ¸Ñ‰ĞµĞ½Ñ‹$(NC)"

clean-old-logs: ## ĞÑ‡Ğ¸ÑÑ‚Ğ¸Ñ‚ÑŒ Ğ»Ğ¾Ğ³Ğ¸ ÑÑ‚Ğ°Ñ€ÑˆĞµ 30 Ğ´Ğ½ĞµĞ¹
	@echo "$(YELLOW)ğŸ—‘ï¸  ĞÑ‡Ğ¸ÑÑ‚ĞºĞ° ÑÑ‚Ğ°Ñ€Ñ‹Ñ… Ğ»Ğ¾Ğ³Ğ¾Ğ² (>30 Ğ´Ğ½ĞµĞ¹)...$(NC)"
	find logs/ -name "test_results_*.log" -mtime +30 -delete 2>/dev/null || true
	find logs/ -name "test_results_*.json" -mtime +30 -delete 2>/dev/null || true
	@echo "$(GREEN)âœ… Ğ¡Ñ‚Ğ°Ñ€Ñ‹Ğµ Ğ»Ğ¾Ğ³Ğ¸ Ğ¾Ñ‡Ğ¸Ñ‰ĞµĞ½Ñ‹$(NC)"

logs: ## ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ»Ğ¾Ğ³Ğ¸ Ñ‚ĞµÑÑ‚Ğ¾Ğ²
	@echo "$(YELLOW)ğŸ“‹ Ğ›Ğ¾Ğ³Ğ¸ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ñ… Ñ‚ĞµÑÑ‚Ğ¾Ğ²:$(NC)"
	docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) logs functional-tests

logs-test: ## ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğ¹ Ğ»Ğ¾Ğ³ Ñ‚ĞµÑÑ‚Ğ¾Ğ²
	@echo "$(YELLOW)ğŸ“‹ ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğ¹ Ğ»Ğ¾Ğ³ Ñ‚ĞµÑÑ‚Ğ¾Ğ²:$(NC)"
	@if [ -d "logs" ] && [ "$$(ls -A logs/)" ]; then \
		LATEST_LOG=$$(ls -t logs/test_results_*.log 2>/dev/null | head -1); \
		if [ -n "$$LATEST_LOG" ]; then \
			echo "$(GREEN)Ğ¤Ğ°Ğ¹Ğ»: $$LATEST_LOG$(NC)"; \
			cat "$$LATEST_LOG"; \
		else \
			echo "$(RED)âŒ Ğ›Ğ¾Ğ³ Ñ„Ğ°Ğ¹Ğ»Ñ‹ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ñ‹$(NC)"; \
		fi; \
	else \
		echo "$(RED)âŒ Ğ”Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ñ logs Ğ¿ÑƒÑÑ‚Ğ° Ğ¸Ğ»Ğ¸ Ğ½Ğµ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚$(NC)"; \
	fi

logs-tail: ## Ğ¡Ğ»ĞµĞ´Ğ¸Ñ‚ÑŒ Ğ·Ğ° Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğ¼ Ğ»Ğ¾Ğ³Ğ¾Ğ¼ Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸
	@echo "$(YELLOW)ğŸ‘€ ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½ĞµĞ³Ğ¾ Ğ»Ğ¾Ğ³Ğ°...$(NC)"
	@if [ -d "logs" ] && [ "$$(ls -A logs/)" ]; then \
		LATEST_LOG=$$(ls -t logs/test_results_*.log 2>/dev/null | head -1); \
		if [ -n "$$LATEST_LOG" ]; then \
			echo "$(GREEN)ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³: $$LATEST_LOG$(NC)"; \
			tail -f "$$LATEST_LOG"; \
		else \
			echo "$(RED)âŒ Ğ›Ğ¾Ğ³ Ñ„Ğ°Ğ¹Ğ»Ñ‹ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ñ‹$(NC)"; \
		fi; \
	else \
		echo "$(RED)âŒ Ğ”Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ñ logs Ğ¿ÑƒÑÑ‚Ğ° Ğ¸Ğ»Ğ¸ Ğ½Ğµ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚$(NC)"; \
	fi

logs-list: ## ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ²ÑĞµÑ… Ğ»Ğ¾Ğ³Ğ¾Ğ²
	@echo "$(YELLOW)ğŸ“‹ Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ²ÑĞµÑ… Ğ»Ğ¾Ğ³Ğ¾Ğ²:$(NC)"
	@if [ -d "logs" ] && [ "$$(ls -A logs/)" ]; then \
		ls -la logs/; \
		echo ""; \
		echo "$(YELLOW)Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°:$(NC)"; \
		echo "Ğ’ÑĞµĞ³Ğ¾ Ğ»Ğ¾Ğ³Ğ¾Ğ²: $$(ls logs/test_results_*.log 2>/dev/null | wc -l)"; \
		echo "JSON Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ¾Ğ²: $$(ls logs/test_results_*.json 2>/dev/null | wc -l)"; \
	else \
		echo "$(RED)âŒ Ğ›Ğ¾Ğ³Ğ¸ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ñ‹$(NC)"; \
	fi

logs-stats: ## ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºÑƒ Ğ¸Ğ· Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½ĞµĞ³Ğ¾ Ğ»Ğ¾Ğ³Ğ°
	@echo "$(YELLOW)ğŸ“Š Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½ĞµĞ³Ğ¾ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:$(NC)"
	@if [ -d "logs" ] && [ "$$(ls -A logs/)" ]; then \
		LATEST_JSON=$$(ls -t logs/test_results_*.json 2>/dev/null | head -1); \
		if [ -n "$$LATEST_JSON" ]; then \
			echo "$(GREEN)JSON Ğ¾Ñ‚Ñ‡ĞµÑ‚: $$LATEST_JSON$(NC)"; \
			python3 -c "import json; data=json.load(open('$$LATEST_JSON')); stats=data['statistics']; print(f'Ğ’ÑĞµĞ³Ğ¾: {stats[\"total\"]}, ĞŸÑ€Ğ¾Ğ¹Ğ´ĞµĞ½Ğ¾: {stats[\"passed\"]}, Ğ£Ğ¿Ğ°Ğ»Ğ¾: {stats[\"failed\"]}, ĞŸÑ€Ğ¾Ğ¿ÑƒÑ‰ĞµĞ½Ğ¾: {stats[\"skipped\"]}')"; \
		else \
			LATEST_LOG=$$(ls -t logs/test_results_*.log 2>/dev/null | head -1); \
			if [ -n "$$LATEST_LOG" ]; then \
				echo "$(GREEN)Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ Ğ¸Ğ· Ğ»Ğ¾Ğ³Ğ°: $$LATEST_LOG$(NC)"; \
				grep "Ğ˜Ğ¢ĞĞ“ĞĞ’ĞĞ¯ Ğ¡Ğ¢ĞĞ¢Ğ˜Ğ¡Ğ¢Ğ˜ĞšĞ" -A 10 "$$LATEST_LOG" | tail -8; \
			else \
				echo "$(RED)âŒ Ğ›Ğ¾Ğ³ Ñ„Ğ°Ğ¹Ğ»Ñ‹ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ñ‹$(NC)"; \
			fi; \
		fi; \
	else \
		echo "$(RED)âŒ Ğ”Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ñ logs Ğ¿ÑƒÑÑ‚Ğ° Ğ¸Ğ»Ğ¸ Ğ½Ğµ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚$(NC)"; \
	fi

logs-backend: ## ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ»Ğ¾Ğ³Ğ¸ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğ³Ğ¾ backend
	@echo "$(YELLOW)ğŸ“‹ Ğ›Ğ¾Ğ³Ğ¸ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğ³Ğ¾ backend:$(NC)"
	docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) logs test-backend

logs-selenium: ## ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ»Ğ¾Ğ³Ğ¸ Selenium Hub
	@echo "$(YELLOW)ğŸ“‹ Ğ›Ğ¾Ğ³Ğ¸ Selenium Hub:$(NC)"
	docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) logs selenium-hub

logs-selenium-chrome: ## ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ»Ğ¾Ğ³Ğ¸ Chrome Node
	@echo "$(YELLOW)ğŸ“‹ Ğ›Ğ¾Ğ³Ğ¸ Chrome Node:$(NC)"
	docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) logs selenium-chrome

selenium-diagnostics: ## Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ğ´Ğ¸Ğ°Ğ³Ğ½Ğ¾ÑÑ‚Ğ¸ĞºÑƒ Selenium Grid
	@echo "$(YELLOW)ğŸ” Ğ”Ğ¸Ğ°Ğ³Ğ½Ğ¾ÑÑ‚Ğ¸ĞºĞ° Selenium Grid...$(NC)"
	docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) exec functional-tests python utils/selenium_diagnostics.py

selenium-status: ## ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚ÑƒÑ Selenium ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ²
	@echo "$(YELLOW)ğŸ“Š Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ Selenium ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ²:$(NC)"
	@echo "Hub ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€:"
	@docker ps --filter "name=selenium-hub" --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}"
	@echo "Chrome Node ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€:"
	@docker ps --filter "name=selenium-chrome" --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}"

selenium-fix: ## ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼ Selenium
	@echo "$(YELLOW)ğŸ”§ ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Selenium Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼...$(NC)"
	python utils/selenium_fix.py

selenium-fix-docker: ## ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Selenium Ğ²Ğ½ÑƒÑ‚Ñ€Ğ¸ Docker
	@echo "$(YELLOW)ğŸ”§ ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Selenium Ñ‡ĞµÑ€ĞµĞ· Docker...$(NC)"
	docker run --rm -v /var/run/docker.sock:/var/run/docker.sock \
		-v $(PWD):/workspace -w /workspace \
		--network host \
		python:3.12-slim bash -c "\
		apt-get update && apt-get install -y docker.io curl && \
		pip install requests && \
		python utils/selenium_fix.py"

selenium-restart: ## ĞŸĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑĞº Selenium ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ²
	@echo "$(YELLOW)ğŸ”„ ĞŸĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑĞº Selenium ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ²...$(NC)"
	docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) restart selenium-hub selenium-chrome

selenium-fix-local: ## Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Selenium (Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ)
	@echo "$(YELLOW)ğŸ”§ Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Selenium Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼...$(NC)"
	./selenium_fix_local.sh

logs-all: ## ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ²ÑĞµ Ğ»Ğ¾Ğ³Ğ¸
	@echo "$(YELLOW)ğŸ“‹ Ğ’ÑĞµ Ğ»Ğ¾Ğ³Ğ¸ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ:$(NC)"
	docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) logs

shell: ## ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒÑÑ Ğº ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ñƒ Ñ‚ĞµÑÑ‚Ğ¾Ğ²
	@echo "$(YELLOW)ğŸš ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğº ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ñƒ Ñ‚ĞµÑÑ‚Ğ¾Ğ²...$(NC)"
	docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) exec functional-tests bash

shell-backend: ## ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒÑÑ Ğº Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğ¼Ñƒ backend
	@echo "$(YELLOW)ğŸš ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğº Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğ¼Ñƒ backend...$(NC)"
	docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) exec test-backend bash

db-shell: ## ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒÑÑ Ğº Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğ¹ Ğ±Ğ°Ğ·Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
	@echo "$(YELLOW)ğŸ—„ï¸  ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğº Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğ¹ Ğ‘Ğ”...$(NC)"
	docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) exec test-postgres psql -U test_user -d test_diplom

status: ## ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚ÑƒÑ ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ²
	@echo "$(YELLOW)ğŸ“Š Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ñ… ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ²:$(NC)"
	docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) ps

health: ## ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ·Ğ´Ğ¾Ñ€Ğ¾Ğ²ÑŒĞµ ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ²
	@echo "$(YELLOW)ğŸ¥ ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ·Ğ´Ğ¾Ñ€Ğ¾Ğ²ÑŒÑ ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ²...$(NC)"
	@python utils/wait_for_services.py || echo "$(RED)âŒ ĞĞµĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğµ ÑĞµÑ€Ğ²Ğ¸ÑÑ‹ Ğ½ĞµĞ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹$(NC)"

install: ## Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ´Ğ»Ñ Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°
	@echo "$(YELLOW)ğŸ“¦ Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹...$(NC)"
	pip install -r requirements.txt
	@echo "$(GREEN)âœ… Ğ—Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ñ‹$(NC)"

reports: ## ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ¾Ñ‚Ñ‡ĞµÑ‚Ñ‹ Ğ² Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğµ
	@echo "$(YELLOW)ğŸ“Š ĞÑ‚ĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ¾Ğ²...$(NC)"
	@if [ -f "reports/all_tests_report.html" ]; then \
		echo "$(GREEN)ĞÑ‚ĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ Ğ¾Ğ±Ñ‰ĞµĞ³Ğ¾ Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ°...$(NC)"; \
		python -c "import webbrowser; webbrowser.open('reports/all_tests_report.html')"; \
	elif [ -f "reports/api_tests_report.html" ]; then \
		echo "$(GREEN)ĞÑ‚ĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ° API Ñ‚ĞµÑÑ‚Ğ¾Ğ²...$(NC)"; \
		python -c "import webbrowser; webbrowser.open('reports/api_tests_report.html')"; \
	else \
		echo "$(RED)âŒ ĞÑ‚Ñ‡ĞµÑ‚Ñ‹ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ñ‹. Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚Ğµ Ñ‚ĞµÑÑ‚Ñ‹ ÑĞ½Ğ°Ñ‡Ğ°Ğ»Ğ°.$(NC)"; \
	fi

coverage: ## ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ¾Ñ‚Ñ‡ĞµÑ‚ Ğ¾ Ğ¿Ğ¾ĞºÑ€Ñ‹Ñ‚Ğ¸Ğ¸
	@echo "$(YELLOW)ğŸ“ˆ ĞÑ‚ĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ° Ğ¾ Ğ¿Ğ¾ĞºÑ€Ñ‹Ñ‚Ğ¸Ğ¸...$(NC)"
	@if [ -f "reports/coverage/index.html" ]; then \
		python -c "import webbrowser; webbrowser.open('reports/coverage/index.html')"; \
	else \
		echo "$(RED)âŒ ĞÑ‚Ñ‡ĞµÑ‚ Ğ¾ Ğ¿Ğ¾ĞºÑ€Ñ‹Ñ‚Ğ¸Ğ¸ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½. Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚Ğµ Ñ‚ĞµÑÑ‚Ñ‹ Ñ Ğ¿Ğ¾ĞºÑ€Ñ‹Ñ‚Ğ¸ĞµĞ¼.$(NC)"; \
	fi

watch: ## ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ğ»Ğ¾Ğ³Ğ¾Ğ² Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸
	@echo "$(YELLOW)ğŸ‘€ ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ğ»Ğ¾Ğ³Ğ¾Ğ² Ñ‚ĞµÑÑ‚Ğ¾Ğ²...$(NC)"
	docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) logs -f functional-tests

# Ğ¡Ğ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ Ğ´Ğ»Ñ CI/CD
ci-test: ## Ğ—Ğ°Ğ¿ÑƒÑĞº Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ğ² CI Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ğ¸
	@echo "$(YELLOW)ğŸ¤– Ğ—Ğ°Ğ¿ÑƒÑĞº Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ğ² CI...$(NC)"
	TEST_TYPE=all docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) up --build --abort-on-container-exit --exit-code-from functional-tests

ci-cleanup: ## ĞÑ‡Ğ¸ÑÑ‚ĞºĞ° Ğ¿Ğ¾ÑĞ»Ğµ CI Ñ‚ĞµÑÑ‚Ğ¾Ğ²
	@echo "$(YELLOW)ğŸ§¹ ĞÑ‡Ğ¸ÑÑ‚ĞºĞ° CI Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ...$(NC)"
	docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) down -v --remove-orphans || true
	docker system prune -f || true

# ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ Ğ´Ğ»Ñ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸
dev-setup: ## ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ Ğ´Ğ»Ñ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸
	@echo "$(YELLOW)âš™ï¸  ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ Ğ´Ğ»Ñ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸...$(NC)"
	@$(MAKE) install
	mkdir -p reports screenshots
	@echo "$(GREEN)âœ… ĞĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ğµ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ¾ Ğ´Ğ»Ñ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸$(NC)"

dev-test: ## Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ Ñ‚ĞµÑÑ‚ Ğ´Ğ»Ñ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ (Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ API)
	@echo "$(YELLOW)âš¡ Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ Ñ‚ĞµÑÑ‚ Ğ´Ğ»Ñ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸...$(NC)"
	pytest api_tests/test_health_api.py -v

dev-test-uuid: ## Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ Ñ‚ĞµÑÑ‚ UUID Ğ´Ğ»Ñ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸
	@echo "$(YELLOW)âš¡ Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ Ñ‚ĞµÑÑ‚ UUID Ğ´Ğ»Ñ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸...$(NC)"
	pytest api_tests/test_buyer_api.py::TestBuyerAPI::test_create_buyer_success -v

# ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ¸
debug-selenium: ## Ğ—Ğ°Ğ¿ÑƒÑĞº Selenium Ğ² Ñ€ĞµĞ¶Ğ¸Ğ¼Ğµ Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ¸
	@echo "$(YELLOW)ğŸ› Ğ—Ğ°Ğ¿ÑƒÑĞº Selenium Ğ² Ñ€ĞµĞ¶Ğ¸Ğ¼Ğµ Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ¸...$(NC)"
	docker run --rm -p 4444:4444 -p 7900:7900 --shm-size=2g selenium/standalone-chrome:4.15.0

debug-backend: ## Ğ—Ğ°Ğ¿ÑƒÑĞº Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğ³Ğ¾ backend
	@echo "$(YELLOW)ğŸ› Ğ—Ğ°Ğ¿ÑƒÑĞº Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğ³Ğ¾ backend...$(NC)"
	docker-compose -f $(COMPOSE_FILE) -p $(PROJECT_NAME) up test-backend test-postgres test-redis

# Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹
info: ## ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ Ñ‚ĞµÑÑ‚Ğ°Ñ…
	@echo "$(GREEN)ğŸ“‹ Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ñ… Ñ‚ĞµÑÑ‚Ğ°Ñ…$(NC)"
	@echo ""
	@echo "$(YELLOW)Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ñ‚ĞµÑÑ‚Ğ¾Ğ²:$(NC)"
	@find . -name "test_*.py" -type f | head -10
	@echo ""
	@echo "$(YELLOW)ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ Ğ¾Ñ‚Ñ‡ĞµÑ‚Ñ‹:$(NC)"
	@ls -la reports/ 2>/dev/null | head -5 || echo "ĞÑ‚Ñ‡ĞµÑ‚Ñ‹ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ñ‹"
	@echo ""
	@echo "$(YELLOW)Ğ Ğ°Ğ·Ğ¼ĞµÑ€ Docker Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²:$(NC)"
	@docker images | grep -E "(functional-tests|selenium|postgres)" | head -5

version: ## ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ²ĞµÑ€ÑĞ¸Ğ¸ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ¾Ğ²
	@echo "$(GREEN)ğŸ”– Ğ’ĞµÑ€ÑĞ¸Ğ¸ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ¾Ğ²$(NC)"
	@echo "Docker: $$(docker --version)"
	@echo "Docker Compose: $$(docker-compose --version)"
	@echo "Python: $$(python --version 2>&1)"
	@echo "Pytest: $$(pytest --version 2>&1 | head -1)"
