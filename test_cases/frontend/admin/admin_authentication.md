# Тест-кейсы: Аутентификация в Admin Frontend

## Тест-кейсы аутентификации

| ID | Название | Предусловия | Шаги | Данные тестирования | Ожидаемый результат |
|---|---|---|---|---|---|
| **TC-AF-AUTH-001** | Успешная авторизация администратора | • Система запущена и доступна<br>• Существует валидный аккаунт администратора в Keycloak<br>• Браузер поддерживает JavaScript | 1. Открыть URL: `http://localhost:8080`<br>2. Нажать кнопку "Войти"<br>3. Ввести учетные данные<br>4. Нажать "Войти" в форме Keycloak | **Логин**: admin@test.com<br>**Пароль**: AdminPass123!<br>**Роль**: admin | • Перенаправление на главную страницу админ-панели<br>• Отображение навигационного меню<br>• Имя пользователя в заголовке<br>• Доступ ко всем административным функциям |
| **TC-AF-AUTH-002** | Неуспешная авторизация с неверным паролем | • Система запущена и доступна<br>• Существует валидный аккаунт администратора | 1. Открыть URL: `http://localhost:8080`<br>2. Нажать кнопку "Войти"<br>3. Ввести корректный логин и неверный пароль<br>4. Нажать "Войти" | **Логин**: admin@test.com<br>**Пароль**: WrongPassword123<br>**Ожидаемая ошибка**: Invalid credentials | • Сообщение об ошибке аутентификации<br>• Пользователь остается на странице входа<br>• Доступ к админ-панели не предоставлен<br>• Форма входа остается активной |
| **TC-AF-AUTH-003** | Неуспешная авторизация с несуществующим пользователем | • Система запущена и доступна<br>• Keycloak настроен корректно | 1. Открыть URL: `http://localhost:8080`<br>2. Нажать кнопку "Войти"<br>3. Ввести несуществующий логин<br>4. Ввести любой пароль<br>5. Нажать "Войти" | **Логин**: nonexistent@test.com<br>**Пароль**: AnyPassword123<br>**Ожидаемая ошибка**: User not found | • Сообщение "Пользователь не найден"<br>• Пользователь остается на странице входа<br>• Доступ к админ-панели не предоставлен<br>• Возможность повторной попытки входа |
| **TC-AF-AUTH-004** | Автоматическое перенаправление неавторизованного пользователя | • Система запущена и доступна<br>• Пользователь не авторизован<br>• Прямая ссылка на внутреннюю страницу | 1. Открыть прямую ссылку: `http://localhost:8080/products`<br>2. Дождаться загрузки страницы<br>3. Проверить URL после перенаправления | **URL**: http://localhost:8080/products<br>**Статус**: Неавторизован<br>**Ожидаемое перенаправление**: Keycloak login | • Автоматическое перенаправление на Keycloak<br>• Внутренние страницы недоступны<br>• После авторизации - возврат на запрошенную страницу<br>• Сохранение изначального URL |
| **TC-AF-AUTH-005** | Выход из системы | • Пользователь авторизован в админ-панели<br>• Активная сессия<br>• Доступ к функциям выхода | 1. Находясь в админ-панели, найти кнопку "Выйти"<br>2. Нажать кнопку выхода<br>3. Подтвердить выход (если требуется)<br>4. Проверить состояние после выхода | **Текущий статус**: Авторизован<br>**Действие**: Logout<br>**Подтверждение**: Да | • Перенаправление на страницу входа<br>• Завершение сессии<br>• Требование повторной авторизации для доступа<br>• Очистка токенов аутентификации |
| **TC-AF-AUTH-006** | Проверка токена при длительной сессии | • Пользователь авторизован в админ-панели<br>• Сессия активна более 30 минут<br>• Настроены таймауты токенов | 1. Оставить админ-панель открытой на 30+ минут<br>2. Попытаться выполнить действие (создать запись)<br>3. Наблюдать поведение системы<br>4. Проверить обновление токена | **Время сессии**: 35 минут<br>**Действие**: Создание продукта<br>**Токен**: Истекший<br>**Обновление**: Автоматическое | • Автоматическое обновление токена ИЛИ<br>• Запрос повторной авторизации<br>• Уведомление об обновлении сессии<br>• Сохранение данных при обновлении |
| **TC-AF-AUTH-007** | Множественные сессии одного пользователя | • Существует валидный аккаунт администратора<br>• Доступны два браузера/вкладки<br>• Keycloak настроен для множественных сессий | 1. Авторизоваться в первом браузере/вкладке<br>2. Открыть админ-панель во втором браузере<br>3. Авторизоваться тем же пользователем<br>4. Проверить работу обеих сессий | **Пользователь**: admin@test.com<br>**Браузер 1**: Chrome<br>**Браузер 2**: Firefox<br>**Политика**: Multiple sessions allowed | • Обе сессии работают корректно ИЛИ<br>• Уведомление о множественных сессиях ИЛИ<br>• Автоматическое завершение предыдущей сессии<br>• Соответствие политике безопасности |
| **TC-AF-AUTH-008** | Обработка ошибок сети при авторизации | • Система запущена<br>• Keycloak временно недоступен<br>• Имитация сетевых проблем | 1. Открыть админ-панель<br>2. Попытаться авторизоваться при недоступном Keycloak<br>3. Наблюдать поведение при сетевых ошибках<br>4. Восстановить соединение и повторить | **Keycloak**: Недоступен<br>**Сеть**: Timeout/Connection refused<br>**Логин**: admin@test.com<br>**Пароль**: AdminPass123! | • Понятное сообщение об ошибке сети<br>• Предложение повторить попытку<br>• Система остается отзывчивой<br>• Автоматическое восстановление при доступности |
| **TC-AF-AUTH-009** | Валидация полей формы входа | • Открыта страница входа в админ-панель<br>• JavaScript включен<br>• Форма входа отображается | 1. Попытаться отправить форму с пустыми полями<br>2. Ввести только логин без пароля<br>3. Ввести только пароль без логина<br>4. Ввести некорректные символы | **Тест 1**: Пустые поля<br>**Тест 2**: Логин: admin@test.com, Пароль: пустой<br>**Тест 3**: Логин: пустой, Пароль: password<br>**Тест 4**: Логин: <script>, Пароль: ' OR 1=1 | • Сообщения валидации для каждого поля<br>• Форма не отправляется с невалидными данными<br>• Четкие инструкции по исправлению<br>• Защита от XSS и инъекций |
| **TC-AF-AUTH-010** | Интеграция с Keycloak SSO | • Пользователь авторизован в другом приложении через Keycloak<br>• Настроен SSO между приложениями<br>• Общий realm в Keycloak | 1. Авторизоваться в другом приложении с Keycloak<br>2. Открыть админ-панель в новой вкладке<br>3. Наблюдать процесс авторизации<br>4. Проверить применение ролей | **Другое приложение**: Seller Frontend<br>**Пользователь**: admin@test.com<br>**Роль**: admin<br>**SSO**: Включен | • Автоматическая авторизация без ввода данных<br>• Корректная работа SSO<br>• Правильное применение ролей и прав<br>• Синхронизация сессий между приложениями |

---

## TC-AF-AUTH-002: Неуспешная авторизация с неверным паролем
**Приоритет**: Высокий  
**Теги**: `#frontend` `#admin` `#auth` `#negative` `#high`

### Предусловия
- Система запущена и доступна
- Существует валидный аккаунт администратора в Keycloak

### Шаги выполнения
1. Открыть URL админ-панели: `http://localhost:8080`
2. Нажать кнопку "Войти"
3. Ввести корректный логин и неверный пароль
4. Нажать кнопку "Войти"

### Ожидаемый результат
- Отображается сообщение об ошибке аутентификации
- Пользователь остается на странице входа
- Доступ к админ-панели не предоставлен

### Постусловия
- Пользователь не авторизован
- Сессия не создана

---

## TC-AF-AUTH-003: Неуспешная авторизация с несуществующим пользователем
**Приоритет**: Высокий  
**Теги**: `#frontend` `#admin` `#auth` `#negative` `#high`

### Предусловия
- Система запущена и доступна

### Шаги выполнения
1. Открыть URL админ-панели: `http://localhost:8080`
2. Нажать кнопку "Войти"
3. Ввести несуществующий логин и любой пароль
4. Нажать кнопку "Войти"

### Ожидаемый результат
- Отображается сообщение об ошибке "Пользователь не найден"
- Пользователь остается на странице входа
- Доступ к админ-панели не предоставлен

---

## TC-AF-AUTH-004: Автоматическое перенаправление неавторизованного пользователя
**Приоритет**: Критический  
**Теги**: `#frontend` `#admin` `#auth` `#security` `#critical`

### Предусловия
- Система запущена и доступна
- Пользователь не авторизован

### Шаги выполнения
1. Открыть прямую ссылку на внутреннюю страницу админ-панели
   Например: `http://localhost:8080/products`
2. Дождаться загрузки страницы

### Ожидаемый результат
- Пользователь автоматически перенаправлен на страницу входа Keycloak
- Внутренние страницы админ-панели недоступны
- После успешной авторизации пользователь перенаправлен на изначально запрошенную страницу

---

## TC-AF-AUTH-005: Выход из системы
**Приоритет**: Высокий  
**Теги**: `#frontend` `#admin` `#auth` `#high`

### Предусловия
- Пользователь авторизован в админ-панели

### Шаги выполнения
1. Находясь в админ-панели, найти кнопку "Выйти" или "Logout"
2. Нажать кнопку выхода
3. Подтвердить выход (если требуется)

### Ожидаемый результат
- Пользователь перенаправлен на страницу входа
- Сессия завершена
- При попытке вернуться на внутренние страницы требуется повторная авторизация

### Постусловия
- Пользователь не авторизован
- Сессия завершена

---

## TC-AF-AUTH-006: Проверка токена при длительной сессии
**Приоритет**: Средний  
**Теги**: `#frontend` `#admin` `#auth` `#session` `#medium`

### Предусловия
- Пользователь авторизован в админ-панели
- Сессия активна более 30 минут

### Шаги выполнения
1. Оставить админ-панель открытой на 30+ минут
2. Попытаться выполнить любое действие (например, создать запись)
3. Наблюдать поведение системы

### Ожидаемый результат
- Система автоматически обновляет токен или запрашивает повторную авторизацию
- Пользователь уведомлен о необходимости обновления сессии
- Данные не теряются при обновлении токена

---

## TC-AF-AUTH-007: Множественные сессии одного пользователя
**Приоритет**: Средний  
**Теги**: `#frontend` `#admin` `#auth` `#session` `#medium`

### Предусловия
- Существует валидный аккаунт администратора

### Шаги выполнения
1. Авторизоваться в админ-панели в первом браузере/вкладке
2. Открыть админ-панель во втором браузере/вкладке
3. Авторизоваться тем же пользователем
4. Проверить работу обеих сессий

### Ожидаемый результат
- Обе сессии работают корректно ИЛИ
- Система уведомляет о множественных сессиях ИЛИ
- Предыдущая сессия завершается автоматически

---

## TC-AF-AUTH-008: Обработка ошибок сети при авторизации
**Приоритет**: Высокий  
**Теги**: `#frontend` `#admin` `#auth` `#network` `#high`

### Предусловия
- Система запущена
- Keycloak временно недоступен или есть проблемы с сетью

### Шаги выполнения
1. Открыть админ-панель
2. Попытаться авторизоваться
3. Наблюдать поведение при сетевых ошибках

### Ожидаемый результат
- Отображается понятное сообщение об ошибке сети
- Предлагается повторить попытку
- Система не "зависает" и остается отзывчивой

---

## TC-AF-AUTH-009: Валидация полей формы входа
**Приоритет**: Средний  
**Теги**: `#frontend` `#admin` `#auth` `#validation` `#medium`

### Предусловия
- Открыта страница входа в админ-панель

### Шаги выполнения
1. Попытаться отправить форму с пустыми полями
2. Ввести только логин без пароля
3. Ввести только пароль без логина
4. Ввести некорректные символы в поля

### Ожидаемый результат
- Отображаются соответствующие сообщения валидации
- Форма не отправляется с невалидными данными
- Пользователь получает четкие инструкции по исправлению

---

## TC-AF-AUTH-010: Интеграция с Keycloak SSO
**Приоритет**: Критический  
**Теги**: `#frontend` `#admin` `#auth` `#keycloak` `#sso` `#critical`

### Предусловия
- Пользователь уже авторизован в другом приложении через Keycloak SSO

### Шаги выполнения
1. Авторизоваться в другом приложении, использующем тот же Keycloak
2. Открыть админ-панель в новой вкладке
3. Наблюдать процесс авторизации

### Ожидаемый результат
- Пользователь автоматически авторизован в админ-панели без ввода учетных данных
- SSO работает корректно
- Роли и права доступа применяются правильно
