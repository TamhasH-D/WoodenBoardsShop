# Тест-кейсы: YOLO детекция досок

## TC-AI-DET-001: Детекция досок на качественном изображении
**Приоритет**: Критический  
**Теги**: `#ai` `#yolo` `#detection` `#critical`

### Предусловия
- AI-сервис детекции запущен на порту 8002
- Подготовлено качественное изображение с четко видимыми досками
- Изображение в формате JPG/PNG, размер до 10MB

### Шаги выполнения
1. Отправить POST запрос на `http://localhost:8002/detect_seg/`
2. Приложить файл изображения в поле `file`
3. Установить заголовок `accept: application/json`
4. Дождаться ответа от AI-сервиса
5. Проанализировать результаты детекции

### Ожидаемый результат
- Статус ответа: 200 OK
- Ответ содержит массив обнаруженных досок
- Каждая доска имеет:
  - `coordinates`: массив координат полигона
  - `confidence`: уверенность детекции (> 0.5)
  - `class`: класс объекта ("board" или аналогичный)
- Количество обнаруженных досок соответствует реальному

### Пример ожидаемого ответа
```json
[
  {
    "coordinates": [[100, 50], [200, 50], [200, 100], [100, 100]],
    "confidence": 0.95,
    "class": "board"
  },
  {
    "coordinates": [[220, 50], [320, 50], [320, 100], [220, 100]],
    "confidence": 0.87,
    "class": "board"
  }
]
```

---

## TC-AI-DET-002: Детекция на изображении с плохим освещением
**Приоритет**: Высокий  
**Теги**: `#ai` `#yolo` `#detection` `#low_light` `#high`

### Предусловия
- AI-сервис детекции запущен
- Подготовлено изображение с досками при плохом освещении

### Шаги выполнения
1. Отправить изображение с плохим освещением на детекцию
2. Проанализировать качество детекции
3. Сравнить с результатами на качественном изображении

### Ожидаемый результат
- AI-сервис обрабатывает изображение без ошибок
- Детекция может быть менее точной (confidence < 0.7)
- Некоторые доски могут быть пропущены
- Ложные срабатывания минимальны
- Время обработки остается приемлемым

---

## TC-AI-DET-003: Детекция на изображении без досок
**Приоритет**: Высокий  
**Теги**: `#ai` `#yolo` `#detection` `#negative` `#high`

### Предусловия
- AI-сервис детекции запущен
- Подготовлено изображение без досок (например, пустая комната)

### Шаги выполнения
1. Отправить изображение без досок на детекцию
2. Проверить ответ сервиса
3. Убедиться в отсутствии ложных срабатываний

### Ожидаемый результат
- Статус ответа: 200 OK
- Ответ содержит пустой массив `[]` или массив с очень низкой уверенностью
- Нет ложных детекций с высокой уверенностью
- Время обработки быстрое

---

## TC-AI-DET-004: Обработка некорректных форматов файлов
**Приоритет**: Средний  
**Теги**: `#ai` `#yolo` `#detection` `#validation` `#medium`

### Предусловия
- AI-сервис детекции запущен

### Шаги выполнения
1. Отправить файл в неподдерживаемом формате (например, .txt)
2. Отправить поврежденный файл изображения
3. Отправить слишком большой файл (> 10MB)
4. Отправить запрос без файла

### Ожидаемый результат
- Статус ответа: 400 Bad Request или 422 Unprocessable Entity
- Понятное сообщение об ошибке
- Сервис остается стабильным
- Нет утечек памяти или зависаний

---

## TC-AI-DET-005: Производительность детекции
**Приоритет**: Высокий  
**Теги**: `#ai` `#yolo` `#detection` `#performance` `#high`

### Предусловия
- AI-сервис детекции запущен
- Подготовлены изображения разных размеров

### Шаги выполнения
1. Отправить изображение 640x480 пикселей
2. Измерить время обработки
3. Отправить изображение 1920x1080 пикселей
4. Измерить время обработки
5. Отправить изображение 4K разрешения
6. Сравнить времена обработки

### Ожидаемый результат
- Изображение 640x480: обработка < 2 секунд
- Изображение 1920x1080: обработка < 5 секунд
- Изображение 4K: обработка < 10 секунд
- Время растет пропорционально размеру изображения
- Память освобождается после обработки

---

## TC-AI-DET-006: Детекция досок разных размеров
**Приоритет**: Высокий  
**Теги**: `#ai` `#yolo` `#detection` `#variety` `#high`

### Предусловия
- AI-сервис детекции запущен
- Подготовлено изображение с досками разных размеров

### Шаги выполнения
1. Отправить изображение с досками разной ширины
2. Отправить изображение с досками разной длины
3. Отправить изображение со смешанными размерами
4. Проанализировать точность детекции для каждого размера

### Ожидаемый результат
- Детектируются доски всех размеров
- Маленькие доски могут иметь меньшую уверенность
- Большие доски детектируются с высокой точностью
- Координаты полигонов точно описывают границы досок

---

## TC-AI-DET-007: Детекция при различных углах съемки
**Приоритет**: Средний  
**Теги**: `#ai` `#yolo` `#detection` `#angles` `#medium`

### Предусловия
- AI-сервис детекции запущен
- Подготовлены изображения досок под разными углами

### Шаги выполнения
1. Отправить изображение досок сверху (90°)
2. Отправить изображение досок под углом 45°
3. Отправить изображение досок сбоку (0°)
4. Сравнить качество детекции

### Ожидаемый результат
- Детекция работает при всех углах съемки
- Лучшие результаты при съемке сверху
- При боковой съемке могут быть пропуски
- Координаты адаптируются к перспективе

---

## TC-AI-DET-008: Детекция досок с перекрытиями
**Приоритет**: Высокий  
**Теги**: `#ai` `#yolo` `#detection` `#overlapping` `#high`

### Предусловия
- AI-сервис детекции запущен
- Подготовлено изображение с частично перекрывающимися досками

### Шаги выполнения
1. Отправить изображение с досками, лежащими друг на друге
2. Проверить детекцию каждой доски
3. Убедиться в отсутствии дублирования

### Ожидаемый результат
- Детектируются как видимые, так и частично скрытые доски
- Каждая доска детектируется как отдельный объект
- Нет дублирования одной доски как нескольких
- Уверенность может быть ниже для перекрытых досок

---

## TC-AI-DET-009: Стресс-тестирование множественными запросами
**Приоритет**: Средний  
**Теги**: `#ai` `#yolo` `#detection` `#stress` `#medium`

### Предусловия
- AI-сервис детекции запущен
- Подготовлены несколько тестовых изображений

### Шаги выполнения
1. Отправить 10 одновременных запросов на детекцию
2. Проверить обработку всех запросов
3. Отправить 50 последовательных запросов
4. Мониторить использование ресурсов

### Ожидаемый результат
- Все запросы обрабатываются успешно
- Время ответа увеличивается пропорционально нагрузке
- Сервис не падает и не зависает
- Память не утекает при множественных запросах
- Возможна очередь запросов при высокой нагрузке

---

## TC-AI-DET-010: Детекция на изображениях с шумом
**Приоритет**: Средний  
**Теги**: `#ai` `#yolo` `#detection` `#noise` `#medium`

### Предусловия
- AI-сервис детекции запущен
- Подготовлены изображения с различным уровнем шума

### Шаги выполнения
1. Отправить изображение с легким шумом
2. Отправить изображение с сильным шумом
3. Отправить размытое изображение
4. Сравнить результаты с чистым изображением

### Ожидаемый результат
- Детекция работает при легком шуме
- При сильном шуме точность снижается
- Размытие влияет на уверенность детекции
- Критические ошибки отсутствуют

---

## TC-AI-DET-011: Валидация координат полигонов
**Приоритет**: Высокий  
**Теги**: `#ai` `#yolo` `#detection` `#coordinates` `#high`

### Предусловия
- AI-сервис детекции запущен
- Подготовлено изображение известного размера с досками

### Шаги выполнения
1. Отправить изображение 1000x1000 пикселей
2. Проверить координаты всех обнаруженных досок
3. Убедиться, что координаты в пределах изображения
4. Проверить формат полигонов

### Ожидаемый результат
- Все координаты X в диапазоне [0, 1000]
- Все координаты Y в диапазоне [0, 1000]
- Полигоны замкнуты (первая точка = последней)
- Минимум 3 точки в полигоне
- Координаты представлены как целые числа

---

## TC-AI-DET-012: Интеграция с основным API
**Приоритет**: Критический  
**Теги**: `#ai` `#yolo` `#detection` `#integration` `#critical`

### Предусловия
- AI-сервис детекции запущен
- Основной backend API запущен
- Сервисы могут взаимодействовать

### Шаги выполнения
1. Через основной API отправить изображение на анализ
2. Проверить передачу запроса в AI-сервис
3. Проверить обработку ответа от AI-сервиса
4. Убедиться в корректной интеграции

### Ожидаемый результат
- Основной API успешно вызывает AI-сервис
- Результаты детекции передаются обратно
- Ошибки AI-сервиса корректно обрабатываются
- Таймауты настроены правильно
- Интеграция работает стабильно
